# <Generative model series #4> - Implicit Models - 4. GANì˜ ë°œì „ - part 1
## Deep Convolutional GAN(DCGAN; 2015-2016) - Convolutional Net + GAN 

- ê¸°ë³¸ GANì˜ fully-connected layerì„ CNNë¡œ ë°”ê¾¸ë©´ ì–´ë–¨ê¹Œ?
	- ì´ë•Œ generatorëŠ” up-samplingì„ ìœ„í•´ de-convolution layerë¥¼ ì“°ì! 
- Spatial max poolingì„ ì§€ìš°ê³ , ëŒ€ì‹  strided convolutionì„ ì“°ì!
- ë˜í•œ, Batch-normalizationì„ ê° layer ë’¤ì— ë„£ì–´ë³´ì! (ê·¸ëŸ¬ë‚˜, generatorì˜  output, discriminatorì˜ input ì—ëŠ” X)
- Generatorì— ReLUë¥¼ hidden layerì— ì“°ê³ , Tanhë¥¼ output layerì— ì“°ì!
- Discriminatorì—ëŠ” Leaky ReLUë¥¼ ì“°ê³ , sigmoid outputì„ ì“°ì.

  <img width="407" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 6 33 28" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/164aabfc-c3a3-41d5-88ae-2f6d6091c87d">

## Deep Convolutional GAN(DCGAN; 2015-2016) - ê²°ê³¼ â€“ Vector arithmetic, Interpolation, representation learning
<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 6 34 36" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/93f13ea3-8f47-47d9-9647-d7db13417c14">

<img width="200" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 6 34 59" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/b04c93f3-8e29-4814-9bf0-1a3198c67d8f">

<img width="250" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 6 35 19" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/fad4493f-ac93-4dbc-9c36-9a2e1ca08dd2">

## Deep Convolutional GAN(DCGAN; 2015-2016) - ì˜ì˜ì™€ ë‚¨ì€ ë¬¸ì œ
GANì´ ì¢‹ì€ í’ˆì§ˆë¡œ ìƒì„±ë˜ê³  interpolationë„ ê°€ëŠ¥í•¨ì„ ë³´ì„!

ê·¸ëŸ¬ë‚˜, ì•„ë˜ ë¬¸ì œë“¤ì€ ê°œì„ ë  ì—¬ì§€ê°€ ë§ìŒ!
- ë¶ˆì•ˆì •í•œ í•™ìŠµ
- ì•„í‚¤í…ì²˜ì— ë”°ë¼ ì„±ëŠ¥ì´ ë§ì´ ë‹¬ë¼ì§„ë‹¤!
- í•˜ì´í¼ íŒŒë¼ë¯¸í„°ì˜ ë³€ê²½ì— ì˜í•´ ì„±ëŠ¥ì´ ë§ì´ ë‹¬ë¼ì§„ë‹¤!

## Improved techniques for training GAN (2016) - OpenAIíŒ€ì— ì˜í•´ GANì˜ ì¶”ê°€ ë°œì „ ë°©í–¥ì´ ì œì‹œë¨!
- Feature matching
- Historical averaging
- Minibatch discrimination
- Virtual batch-normalization
- One-side label smoothing
- Semi-supervised learning
- Inception Score(exp($ğ¸_x ğ·_{KL}$ (ğ‘(ğ‘¦|ğ‘¥)||ğ‘(ğ‘¦)))ë„ ì—¬ê¸°ì„œ ì œì•ˆë˜ì—ˆë‹¤.
  - ëª¨ë¸ì˜ ì„±ëŠ¥ê³¼ ì‚¬ëŒì˜ íŒë‹¨ì„ correlate ì‹œí‚¨ë‹¤!
  - ìƒì„±ë¬¼ì˜ ë‹¤ì–‘ì„±ì„ ë³´ì¥í•  ìˆ˜ ìˆë‹¤!

## Improved techniques for training GAN (2016) - Feature matching
- Discriminatorì— ìƒˆë¡œìš´ ëª©í‘œë¥¼ ì§€ì •í•˜ì—¬ over-trainingì„ ë°©ì§€í•˜ê³ , GANì˜ ë¶ˆì•ˆì •ì„± (i.e. discriminator saturation, module collapsed)ì„ ì™„í™”
- Generatorì—ì„œ ìƒì„±í•œ ë¶„í¬ì™€ ì‹¤ì œ ë°ì´í„°ì˜ ë¶„í¬ë¥¼ matching ì‹œí‚¤ê¸° ìœ„í•´ Discriminator ì¤‘ê°„ì¸µì˜ activation í•¨ìˆ˜ë¥¼ ì´ìš©
  -  ì§„ì§œ ê°€ì§œë¥¼ ë‚˜ëˆ„ëŠ” ê²ƒì´ ì•„ë‹Œ, ì§„ì§œì™€ ê°™ì€ featureì„ ê°€ì§€ê³  ìˆëŠ”ì§€ë¥¼ íŒŒì•…í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í•™ìŠµì„ ì§„í–‰
- ğ‘“(ğ‘¥) : discriminatorì˜ ì¤‘ê°„ layerì˜ activation í•¨ìˆ˜ë¼ë©´, ìƒˆë¡œìš´ ì†ì‹¤ í•¨ìˆ˜ëŠ” ë‹¤ìŒì´ ëœë‹¤!

  <img width="200" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 7 07 40" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/c55d0a8c-448f-45ca-80e2-814aaf3f900a">

- Discriminator ì¤‘ê°„ì¸µì˜ outputì´ ìƒì„±ì— í•„ìš”í•œ í•˜ë‚˜ì˜ íŠ¹ì§•(feature)ì´ë©°, random samplingëœ zì— ëŒ€í•´ ë¶„í¬ê°€ ë¹„ìŠ·í•œì§€(matching) ì‚´í´ë³´ëŠ” ê²ƒ
- Gê°€ ëª©í‘œí•˜ëŠ” ë¶€ë¶„ê¹Œì§€ ë„ë‹¬í•˜ëŠ” ì§€ í™•ì¸í•  ìˆ˜ ì—†ì§€ë§Œ, GAN í•™ìŠµì˜ ë¶ˆì•ˆì •ì„± ì™„í™”ì— íš¨ê³¼ì ì„ì„ ì‹¤í—˜ì ìœ¼ë¡œ í™•ì¸!

## Improved techniques for training GAN (2016) - Historical averaging
- Discriminatorì™€ generatorì˜ ì†ì‹¤ í•¨ìˆ˜ì— ì•„ë˜ì˜ ì‹ì„ ì¶”ê°€.
- ğœƒê°€ ëª¨ë¸ íŒŒë¼ë¯¸í„°, ğœƒ[ğ‘–]ê°€ ië²ˆì§¸ í•™ìŠµ ê³¼ì •ì—ì„œ íŒŒë¼ë¯¸í„°ë¥¼ ì˜ë¯¸í•˜ë©´,

  <img width="130" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 7 11 32" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/4ae796ba-9580-4ee8-b375-9d79f846d655">

- Long-time seriesì—ì„œë„ ì˜ ì‘ë™í•˜ê²Œ ë„ì™€ì¤Œ!

## Improved techniques for training GAN (2016) - Minibatch discrimination
- GANì´ ì‹¤íŒ¨í•˜ëŠ” ê²½ìš° ì¤‘ í•˜ë‚˜ëŠ” Generatorê°€ ë™ì¼í•œ(ìœ ì‚¬í•œ) ì¶œë ¥ì„ í•˜ê²Œ parameterê°€ í•™ìŠµë˜ëŠ” ê²½ìš°! 
	- GeneratorëŠ” discriminatorì„ ì†ì´ê¸°ë§Œ í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì— ë°œìƒ!
- Vanilla GAN ë“±ì—ì„œ ì •êµí•˜ê²Œ ì„¸íŒ…í•˜ì§€ ì•Šê³  ì‹¤í—˜í•˜ë©´ ì´ˆê¸° noiseì— ë”°ë¼ Lossê°€ ê¸‰ê²©í•˜ê²Œ ì¤„ì–´ë“¤ê³  ê²°ê³¼ë¥¼ í™•ì¸í•˜ë©´ ì´ìƒí•œ noiseë§Œ ì¶œë ¥í•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤!
	- Discriminatorê°€ ê° exampleì„ ê°œë³„ë¡œ ì²˜ë¦¬í•˜ê¸° ë•Œë¬¸ì— ì¶œë ¥ ê°„ì˜ ê´€ê³„ë¥¼ ê³ ë ¤í•˜ì§€ ì•Šê¸° ë•Œë¬¸ ì¦‰, ë™ì¼í•œ example ì„ ë™ì¼í•œ ê²ƒìœ¼ë¡œ ì¸ì‹í•˜ì§€ ëª»í•œë‹¤.
	- ë°°ì¹˜(batch) ì•ˆì—ì„œ ë‹¤ë¥¸ ë°ì´í„° ê°„ì˜ ê´€ê³„ë¥¼ ê³ ë ¤í•˜ë„ë¡ ì„¤ê³„í•˜ì!

## Improved techniques for training GAN (2016) - Minibatch discrimination
-> Discriminatorê°€ ë°°ì¹˜(batch) ì•ˆì—ì„œ ë‹¤ë¥¸ ë°ì´í„° ê°„ì˜ ê´€ê³„ë¥¼ ê³ ë ¤í•˜ë„ë¡ ì„¤ê³„í•˜ì!

 <img width="200" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 7 27 00" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/3db8d24e-037d-4225-aa25-ed00d24d9e56">
	
- $f(x_i) \in R^A$ : input $x_i$ ì— ëŒ€í•œ feature vecture (latent vector)
  - discriminatorì˜ ì¤‘ê°„ ë ˆì´ì–´ì— ì˜í•´ ìƒì„±
  - $f(x_i)$ ì— ğ‘‡ âˆˆ $R^{AXBXC}$ í…ì„œë¥¼ ê³±í•´ Matrix M( $M_i \in R^{BXC}$ )ì„ê³„ì‚°!
  - ê·¸ë¦¬ê³  ë³¸ matrixì˜ row ê°„ L1-distanceì„ ê³„ì‚°í•œë‹¤.

    <img width="200" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 7 24 54" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/84aca648-359a-4019-a5ec-9ad16bf3ea81">

ìƒ˜í”Œ $x_i$ ê°€ ìˆì„ ë•Œ Minibatch layerì— ëŒ€í•œ output layer ğ‘œ( $x_i$ ) ëŠ” ì•„ë˜ì™€ ê°™ì´ ì •ì˜í•˜ê³  discriminatorê°€ ì´ë¥¼ ê³ ë ¤í•˜ê²Œ í•œë‹¤!

<img width="200" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 7 25 58" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/5e6ce2c6-8e30-47ba-9e2d-5e6001061530">

- ì‹œê°ì ìœ¼ë¡œ ì¢‹ì€ ìƒ˜í”Œì„ ë³´ë‹¤ ì˜ ìƒì„±!
  
  <img width="200" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 7 27 42" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/8d61a3c5-cca2-4684-be48-ef2e1638351a">

## Improved techniques for training GAN (2016) - One-sided label smoothing
- íƒ€ê²Ÿ ë ˆì´ë¸”ë¡œ 0(Fake)/1(Real) ëŒ€ì‹  0.1/0.9 ë“±ì˜ smoothed valueë¡œ Discriminatorì„ í›ˆë ¨.
- Label smoothingì´ë¼ê³ ë„ í•œë‹¤.
- CE: cross entropyë¼ë©´,
- Cross entropyì„ ì‚¬ìš©í•  ë•Œ Discriminatorì˜ ë¹„ìš©?
  - ê¸°ì¡´: CE(1, discriminator(data) + CE(0, discriminator(samples))
  - ì œì•ˆ: CE(.9, discriminator(data) + CE(0., discriminator(samples))
 
## Improved techniques for training GAN (2016) - One-sided label smoothing
ì™œ one-sideë¼ í• ê¹Œ?
- ğ›¼ : positive label (real data) ğ›½: negative label (generator output) ì´ ì£¼ì–´ì§ˆ ë•Œ,
- ìµœì ì˜ discriminatorëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

  <img width="200" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 7 31 26" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/b400b68e-ca00-4cf7-bfeb-ebd8968e73e7">

- ë¶„ìì˜ ğ›½í•­ì´ 0ì´ì•„ë‹ˆë¼ë©´, discriminatorì˜ ìµœì ê°’ì´ ë³€í•˜ê²Œ ë§Œë“ ë‹¤!
- Discriminatorê°€ generatorê°€ p_data(x)ì— ê°€ê¹Œì›Œì§€ëŠ”ê²ƒì„ ì˜¤íˆë ¤ë°©í•´í•œë‹¤.
  - ğœ· $ğ’‘_{ğ’ğ’ğ’…ğ’†ğ’}(ğ’™)$ ì„ 0ë¡œ í•˜ì—¬ positive labelë§Œì„ smoothingí•œë‹¤.

## Improved techniques for training GAN (2016) - Virtual batch normalization
Batch normalizationë¡œ ì¸í•´ Mini batch ì˜ ê°’ë“¤ì´ Discriminator ì¶œë ¥ì— ì„œë¡œ ì˜í–¥ì„ ì¤Œ. 
- ê³ ì •ëœ ë°°ì¹˜(reference batch)ì„ ì´ìš©í•˜ì—¬ í•´ê²°
Reference batchëŠ” í•™ìŠµ ì´ˆê¸°ì— í•œë²ˆ ì„ ë³„ë˜ì–´ í•™ìŠµì´ ì§„í–‰ë˜ëŠ” ë™ì•ˆ ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤!
- ì´ ê°’ì„ ì´ìš©í•˜ì—¬ normalize!
generatorì—ì„œë§Œ ì§„í–‰!
- 2ê°œì˜ minibatchì„ forward propagationí•˜ëŠ” ê²ƒì€ ëŠë¦¬ê¸° ë•Œë¬¸

## Improved techniques for training GAN (2016) - Semi-supervised learning
- Discriminatorì—ì„œ fake/true label(y)ì„ ë‹¨ìˆœíˆ predictí•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, p(x, y)ì„ approximateí•˜ë„ë¡
ì¦‰, semi-supervisedë¡œ ëª¨ë¸ë§í•  ìˆ˜ ìˆë‹¤!
- Kê°œ classì—ì„œ generatorê°€ ë§Œë“¤ì–´ë‚´ëŠ” ê°’ì„ ë‹¤ë¥¸ class(K+1)ë¡œ ì¡ì•„, supervisedì™€ unsupervisedë¡œ ë§Œë“ ë‹¤.
- ë°˜ë©´, GeneratorëŠ” ì¡°ê±´ p(x | y)ì„ ë§Œë“¤ì§€ ì•Šê¸°ì—, íŠ¹ë³„í•œ ì—…ë°ì´íŠ¸ê°€ í•„ìš”í•˜ì§€ ì•Šë‹¤.
  - ê·¸ëŸ¬ë¯€ë¡œ semi-supervisedí™˜ê²½ì—ì„œëŠ” Generatorì— ë¹„í•´ discriminatorì— ë³´ë‹¤ ê¹Šì€ architectureì„ ì“°ë©´ ì¢‹ë‹¤.
  
  <img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 7 57 45" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/f1e14ade-ac5d-41a1-9a67-8afbb651c80e">
  
  <img width="500" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 7 58 22" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/3543b034-20ce-40fc-81d3-d0fa09482999">

# Meta Learning - 2. Metric-based Meta Learning
## Metric-based Meta Learning - Siamese Neural Networks for One-shot Image Recognition (2015)
<img width="500" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 24 24" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/e3ba1139-26c9-44a0-8288-b8498c1eb74e">

- Siamese networkì˜ embedding function $f_\theta$ ì—ì„œ, contrastive lossë¡œ similarity ($d=|f_\theta (x_1) âˆ’f_\theta (x_2)|$ )ë¥¼train
  - $p(x_i, x_j) = Ïƒ(Wd)$ ë¡œ MLPë¥¼ ê±°ì¹œê°’ì´ë¼ í•˜ì.
- LossëŠ”?

  <img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 20 08" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/2b619bd4-10e3-484f-a314-baba0aee21b7">

## Metric-based Meta Learning - Siamese Neural Networks for One-shot Image Recognition (2015)

Test imageì— ëŒ€í•œ predictionì€? 
- Support set S, test image xê°€ ì£¼ì–´ì¡Œì„ ë•Œ,

<img width="150" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 27 16" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/2191acd9-1c95-44a3-9ba3-c9f43eaed78a">
ğ‘(x)ëŠ” ì´ë¯¸ì§€ xì˜ class label.

- ë¯¸ë¦¬ ë‹¤ë¥¸ ì´ë¯¸ì§€ë¡œ contrastive learningì„ í•œ ì´í›„ , Pë¥¼ ì–»ì–´ downstream taskë¡œ one-shot learningì„ ì ìš©í•œë‹¤.

  <img width="200" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 29 00" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/7956bc78-5e65-478a-b1b0-07197b619987">

## Metric-based Meta Learning - Matching Networks for One-shot Learning (2016)
<img width="281" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 34 42" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/0f769d13-44ea-417a-a428-f102dc94024e">

Support set ğ‘† = { $(ğ‘¥_i , ğ‘¦_i)$ } (i=1~k) (k-shot ë¶„ë¥˜) ê°€ ì£¼ì–´ì§€ê³ , test exampleì´ xë¼ í–ˆì„ ë•Œ, classifier $ğ¶_s$ ë¥¼ êµ¬í•œë‹¤.  
ì—¬ê¸°ì„œëŠ” attention kernel ğ‘ $(ğ‘¥, ğ‘¥_i)$ ë¡œ similarityë¥¼ ê³„ì‚°í•œë‹¤.

<img width="250" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 32 00" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/235db88a-ed0a-44a6-ae60-c577340276e5">

ì´ë•Œ, cosine similarityë¥¼ cos ë¼ê³  í•˜ë©´, ğ‘ $(ğ‘¥, ğ‘¥_i)$ ëŠ” softmaxì— ì˜í•´ normalizedë˜ì–´ ë‹¤ìŒê³¼ ê°™ì´ í‘œí˜„ë  ìˆ˜ ìˆë‹¤!

<img width="250" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 33 09" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/c840bf4e-8d4c-48eb-975f-537c53df5001">

ìµœì í™” : <img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 33 39" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/1a9459e1-a4da-4a12-8501-c4039b88c3f0">
- ì°¸ê³ : ğ‘“ (ğ‘¥) , $ğ‘” (ğ‘¥_i)$ ì˜ ì„ íƒì€ ì¤‘ìš”! Ã  ì—¬ê¸°ì—ì„œëŠ” LSTM with attention Bi-directional LSTM ì‚¬ìš© (Full context embedding)

## Metric-based Meta Learning - Matching Networks for One-shot Learning (2016)
<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 40 51" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/83abeb58-252c-436f-8c6c-9aa8101caf19">
<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 41 02" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/21e38a43-affb-46b5-9892-cc19d41ed6fe">

## Metric-based Meta Learning - Prototypical Networks for Few-shot Learning (2017)
- Embedding function $f_\theta$ ë¥¼ M-dimension feature vectorë¡œ encodeí•˜ê¸° ìœ„í•´ ì‚¬ìš©!

  <img width="500" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 41 59" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/07b650ef-6c09-4272-a9b5-cf49f600da8b">

- Prototype feature vector: $v_c$ :ê° classë³„ support data sampleì˜ embeddingëœ ê°’ì˜ í‰ê·  ë²¡í„°ë¡œ ì •ì˜

  <img width="150" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 42 29" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/519aa5c7-e099-4fef-a0a1-ed4c0ae79c2c">
  
  <img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 42 55" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/75d5a377-d2ed-4e43-8e6f-f9833ea8a4a2">

- ğœ™ê°€ ë¯¸ë¶„ê°€ëŠ¥í•˜ë‹¤ë©´, $ğ‘‘_\phi$ ëŠ” ì–´ë– í•œ distance functionì—¬ë„ ê´œì°®ê³ , paperì—ì„œëŠ” L2ë¡œ ì´ìš©
- LossëŠ” negative log-likelihoodë¡œ ì •ì˜ëœë‹¤.
  - $ğ¿(ğœƒ) = âˆ’log ğ‘ƒ_\theta ( ğ‘¦ = ğ‘ |ğ‘¥)$

## Metric-based Meta Learning - Prototypical Networks for Few-shot Learning (2017)
<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 44 44" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/d6e9e9bb-3009-4099-adf9-e843f0e9b3c5">

## Metric-based Meta Learning - Relation network for few-shot Learning (2018)
<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 50 07" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/ecc44390-d068-4184-bfa7-242af98afaf9">

Siamese networkì™€ ìœ ì‚¬! But 
1. L1 distanceëŒ€ì‹ , CNNì—ì„œ ìƒ˜í”Œ ê°„ ê´€ê³„ ì •ë„ ê³„ì‚°
  - $ğ‘Ÿ_{ij} = ğ‘”_\phi ([ğ‘“_\rho (ğ‘¥_i), ğ‘“_\rho(ğ‘¥_j)])$

2. MSE lossì‚¬ìš©
  -  ğ¿ (ğµ) = $âˆ‘_{x_i, x_j, y_i, y_j \in B} (r_{ij} - 1_{y_i = y_j})^2$

## Metric-based Meta Learning - Relation network for few-shot Learning (2018)
<img width="500" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 51 12" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/43421a15-2c1f-45da-869a-cdee61e13318">

<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 51 27" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/e5669b27-5b08-40ef-8678-06ea068fccf8">

<img width="500" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 51 49" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/2af71ca3-0647-4063-b57c-f919932b9aee">

## Metric-based Meta Learning - Relation network for few-shot Learning (2018)
<img width="500" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 52 34" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/dbc836f3-5edd-43d5-a5ba-62f0327ea2cc">

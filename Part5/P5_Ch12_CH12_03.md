 # <Generative model series #4> Implicit Models - 3. Generative Adversarial Network(GAN)
 ## Generative Adversarial Network (GAN)
- 2ê°œì˜ ëª¨ë¸ì´ ê²½ìŸì ìœ¼ë¡œ í•™ìŠµí•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ? (ê²Œì„ ì´ë¡ ê³¼ ê°™ì´)
- 2014ë…„ Ian Goodfellowì— ì˜í•´ ì œì•ˆ.
  - min max ğ‘‰ (ğ·, ğº) = $ğ¸_{x \sim {p_{data}(x)}}$ [log ğ· (ğ‘¥)] + $ğ¸_{z \sim {p_{z}(z)}}$ [log(1 âˆ’ ğ·(ğº (ğ‘§) ))] 
- 2ê°œì˜ í”Œë ˆì´ì–´(ìƒì„± ëª¨ë¸-generative model(G)ì™€ ì‹ë³„ ëª¨ë¸ -discriminative model(D))ê°€ ìˆë‹¤ê³  í•´ë³´ì.
- (D)ëŠ” ë°ì´í„°ê°€ ì§„ì§œ(1)ì¸ì§€ ìƒì„± ëª¨ë¸ì´ ë§Œë“  ê°€ì§œ(0)ì¸ì§€ êµ¬ë¶„í•˜ëŠ” binary classifierì´ë‹¤.
- (G)ëŠ” ìƒì„±í•˜ëŠ” ìƒ˜í”Œì˜ log-probabilityì„ ìµœì†Œí™”! -> (D)ì— ì˜í•´ ê°€ì§œë¡œ ë¶„ë¥˜ë˜ëŠ” ìƒ˜í”Œ

<img width="500" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/25255982-1d15-478c-9df4-8549e1df971c">

ì´ ê²Œì„ì˜ ìµœì¢… ê²°ê³¼ëŠ” ? (Nash equilibrium)
- $p_{data}(x) = p_g (x), \forall x$
- ğ· (ğ‘¥) = 1/2 , âˆ€ ğ‘¥

<img width="162" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 01 24" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/f5e8796e-44ea-4ea0-81e2-83e4e987a1da">

## Generative Adversarial Network (GAN) - ìµœì ì˜ discriminator(ëª©ì  í•¨ìˆ˜)
<img width="350" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 05 01" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/8536db77-7033-4102-ae8a-e9d4493b2d56">

Generatorë¥¼ ê³ ì •í•˜ê³  discriminatorì˜ ìµœì  ê°’ì„ ì°¾ìœ¼ë©´

<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 02 21" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/0f933d55-20ba-4abe-8961-e4558994c4fa">

ì—¬ê¸°ì„œ <img width="80" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 03 13" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/2b9b56ab-8fa4-4403-8cd4-1d94063002ff"> ì´ë˜ëŠ”ë•Œë¥¼ ì°¾ì•„ ìµœì ì˜ê°’ì„ì°¾ëŠ”ë‹¤.

<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 04 02" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/cf48fed0-5689-46c0-967d-57bad64ac866">

## Generative Adversarial Network (GAN) - ìµœì ì˜ discriminator & generator(ëª©ì  í•¨ìˆ˜)
ğ‘‰ (ğº, ğ·) ì— <img width="150" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 07 24" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/97629e2f-99ee-41c4-b90c-b5d628c03852"> ì„ ëŒ€ì…í•˜ê³  ì •ë¦¬í•˜ë©´,   

<img width="450" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 07 57" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/36e5cc93-fa52-4f2d-bfe4-c521bcd817ac">

-> $p_{data}, p_g$ ì— ëŒ€í•œ 2*Jensen-Shannon divergence (JSD)ì´ê³  >=0 ì´ë‹¤!  
-> Divergenceì´ë¯€ë¡œ, ì„±ì§ˆì— ë”°ë¼ $p_{data} = p_g$ ì¼ ë•Œ ìµœì†Œì´ê³  ìµœì†Œê°’ì€ 0!   
-> ğ‘‰ ğºâˆ—,ğ·âˆ— = âˆ’log4 ì´ë‹¤!

## Generative Adversarial Network (GAN) - Jensen-Shannon Divergence(JSD) vs KL Divergence vs Maximum mean discrepancy (MMD)
<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 10 07" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/230cb553-30b4-4a39-88ed-8bf88d83a0cc">    
     
<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 10 37" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/6f934076-1e11-49c9-8a1d-554382379d18">   
  
<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 11 01" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/b6384801-1f85-4c79-9849-b26ddd5f420b">    

## Generative Adversarial Network (GAN) - Generator, discriminatorì˜ ëª©ì  í•¨ìˆ˜ì™€ ì—…ë°ì´íŠ¸
<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 14 11" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/af9de431-c1a0-4914-a3c5-84c8cd63e677">

ì—ì„œ discriminatorì™€ generatorì— ëŒ€í•´ ëª©ì í•¨ìˆ˜ë¥¼ ê°ê° ì •ì˜í•˜ë©´,

<img width="525" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 15 07" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/1ccdd760-8d6c-4fd8-a088-10edaa73f312">
ì´ë‹¤.

- ëª©ì  í•¨ìˆ˜ì— ë”°ë¼ íŒ¨ëŸ¬ë¯¸í„°ëŠ” ë§¤ ìŠ¤í…ë§ˆë‹¤ ì•„ë˜ì™€ ê°™ì´ ì—…ë°ì´íŠ¸ ëœë‹¤.

  <img width="207" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 15 40" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/b316b0c7-3ba2-4bd8-975d-0bf7c7f0770e">

## Generative Adversarial Network (GAN) - í•™ìŠµê³¼ì •
<img width="450"  src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/dd94cc09-03b9-4ee0-ad62-25083af50b61">

## Generative Adversarial Network (GAN) - Discriminator saturation (vanishing gradient problem)
<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 24 33" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/1325bfa7-230b-4e8a-967f-40c323c72a6a">

ì—ì„œ Generative ë¶€ë¶„ <img width="250" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 25 02" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/a40d4b47-9d3a-4c70-90aa-644238921092"> ì„ ê·¸ëŒ€ë¡œ ìµœì í™”í•˜ë©´?

<img width="250" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 26 03" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/d21e5049-291f-409c-90f2-1b7e22ba121e">

ì´ë•Œ, ğ·(ğ‘¥)ëŠ” binary classificationì´ê¸° ë•Œë¬¸ì— sigmoidì„ ì“´ë‹¤.

<img width="190" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 26 39" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/64063732-231a-4d98-ad61-3ff3200ac281"> ë¼ë©´,

<img width="493" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 27 21" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/fb3c2768-88ba-47fc-8f50-542b281b24dc">ì´ ëœë‹¤.

ë§Œì•½, discriminatorê°€ confidentí•˜ë‹¤ë©´ ìœ„ì˜ ê°’ì€ 0ì´ ë˜ì–´, generatorê°€ ì—…ë°ì´íŠ¸ê°€ ë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ìƒê¸´ë‹¤. ì´ë¥¼ discriminator saturation ë¬¸ì œë¼ê³  í•œë‹¤!

## Generative Adversarial Network (GAN) - Discriminator saturationì´ í•´ê²°ëœ GAN
<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 28 27" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/db8fe76b-2868-40b2-9a0f-1f16df234028">

ì—ì„œ Generative ë¶€ë¶„ì˜ ëª©ì  í•¨ìˆ˜ <img width="250" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 28 44" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/67466bf0-a1e6-40ae-bd6c-6517c6f2be63"> ì˜ ìµœì†Œí™” ëŒ€ì‹ 

<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 29 22" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/6afe4f98-486e-4133-9a96-fa276eaaa077"> ì„ ìµœì†Œí™”í•˜ì—¬ ìµœì í™” í•œë‹¤!

(discriminatorëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€)

- êµì • ì „ì²˜ëŸ¼, ë‘ ì—…ë°ì´íŠ¸ê°€ zero-sum ê²Œì„ì„ í•˜ê³  ìˆë‹¤ë©´, balancingì„ í•˜ëŠ” ê²ƒì€ ë§¤ìš° ì–´ë ¤ìš¸ ê²ƒì´ë‹¤ !
- GANì—ì„œëŠ” ìœ„ì˜ êµì •ìœ¼ë¡œ adversarial(ì ëŒ€ì )ë¡œ ê²Œì„ì„ ì •ì˜í•˜ì—¬ non-zero sumì„ ë§Œë“¤ì–´ ìµœì í™”ë¥¼ ìš©ì´í•˜ê²Œ ê°œì„ í•  ìˆ˜ ìˆì—ˆë‹¤! - Discriminator saturation ë¬¸ì œë¥¼ í•´ê²°

## Generative Adversarial Network (GAN) - ê²°ê³¼
<img width="350" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 50 59" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/50495687-c974-43ff-aacf-4dfc5dd1eff9">

## Generative Adversarial Network (GAN) - GANì„ í‰ê°€í•˜ëŠ” ë°©ë²•
- GANì„ í‰ê°€í•˜ëŠ” ë°©ë²•ì€ ì•„ì§ ì—´ë¦° ë¬¸ì œì´ë‹¤.
  - Why? : Explicití•œ ë¬¸ì œì™€ ë‹¤ë¥´ê²Œ, likelihoodì„ test-setì— ëŒ€í•´ í‰ê°€í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸!
- í‰ê°€ì— ë¬´ì—‡ì´ ì¤‘ìš”í• ê¹Œ?
  1. Fidelity: ì´ë¯¸ì§€ì˜ í€„ë¦¬í‹°
  2. Diversity: ì´ë¯¸ì§€ì˜ ë‹¤ì–‘ì„±
GANì˜ metricsë“¤
- Parzen-Window density estimator
- Inception Score
- Frechet Inception Distance
- Sampling & Truncation
- HYPE (Human eYe Perceptual Evaluation)

## Generative Adversarial Network (GAN) - GANì„ í‰ê°€í•˜ëŠ” ë°©ë²• â€’ Parzen-Window density estimator
- Kernel density estimator ë¼ê³ ë„ ì•Œë ¤ì ¸ ìˆë‹¤!
- EstimatorëŠ” kernel K í•¨ìˆ˜ì™€ bandwidth hë¡œ ì´ë£¨ì–´ì ¸ ì•„ë˜ ì‹ì„ ë§Œì¡±í•œë‹¤.

  <img width="150" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 55 48" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/977d0aa2-f8f7-4bcf-a08d-7a6f35ca7535">

  <img width="150" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 54 55" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/aa5eb530-7470-45ba-a87e-4dcd7883b4b5">

- ìƒì„± ëª¨ë¸ í‰ê°€ì—ì„œ,
  - KëŠ” í‘œì¤€ ì •ê·œ ë¶„í¬ì˜ ë°€ë„ í•¨ìˆ˜ë¡œ ì„ íƒëœë‹¤.
  - HëŠ” validation setì˜ ë¶„ì„ì„ í†µí•´ ì„ íƒí•œë‹¤.

<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 56 33" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/23662a7c-862d-40ef-a895-fa7e064aad15">

- ê·¸ëŸ¬ë‚˜ ì •í™•í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆë‹¤

  <img width="450" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 57 02" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/5a3b943b-2fcf-4648-a425-c6a371c8e256">

## Generative Adversarial Network (GAN) - GANì„ í‰ê°€í•˜ëŠ” ë°©ë²• â€’ Inception score
- Inception p(y|x) classifier ëª¨ë¸ (i.e. pre-trainingëœ inception v3 ë„¤íŠ¸ì›Œí¬ì‚¬ìš©)
- marginal label distribution (label ë“¤ì˜ í™•ë¥  ë¶„í¬) <img width="150" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 58 34" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/225118a0-7479-42f0-b2db-15495d406964">
- ìœ„ ë‘ ë¶„í¬ ê°„ KL divergence expectationì˜ ì§€ìˆ˜ ì œê³±

  <img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 5 59 35" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/21ff7724-3373-4971-b3be-b10069b32a98">

- ê°€ì¥ë„ë¦¬ì‚¬ìš©ë˜ëŠ”ì§€í‘œì¤‘í•˜ë‚˜!

## Generative Adversarial Network (GAN) - GANì„ í‰ê°€í•˜ëŠ” ë°©ë²• â€’ Frechet Inception Distance
<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 6 05 34" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/6f0b91bb-d94f-4f19-aab8-4f8111623ea8">

- ë‚®ì€ FID -> ë‘ ë¶„í¬ì˜ ê±°ë¦¬ê°€ ê°€ê¹ë‹¤ : ì§„ì§œì™€ ê°€ì§œê°€ ìœ ì‚¬í•˜ë‹¤!

  <img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-20 á„‹á…©á„’á…® 6 14 39" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/4f13c14c-906a-468e-bb70-8b2103e6e84d">

- ë‹¨ì ?
  - ImageNet dataë¡œ pre-trainedëœ ê²½ìš° ImageNet data ì´ë¯¸ì§€ì˜ classì™€ ë‹¤ë¥¸ ì´ë¯¸ì§€ë¥¼ ë‹¤ë£° ê²½ìš° ì›í•˜ëŠ” íŠ¹ì§•ì„ í¬ì°©í•˜ì§€ ëª»í•  ìˆ˜ìˆë‹¤.
  - Pre-trainedê°€ ì•„ë‹Œ ê²½ìš°, ë§ì€ ìˆ˜ì˜ sampleë¡œ í•™ìŠµì‹œí‚¤ì§€ ì•Šìœ¼ë©´ biased feature layerê°€ ìƒê²¨ì„œ ì¢‹ì§€ ëª»í•œ FID scoreë¥¼ ì–»ê²Œëœë‹¤
  - Pre-trainedê°€ ì•„ë‹Œê²½ìš°, í•™ìŠµì„ ì‹œí‚¤ê¸° ìœ„í•´ ì˜¤ë˜ê±¸ë¦°ë‹¤.
  - í‘œë³¸ì˜ ë¶„í¬ê°€ ì •ê·œ ë¶„í¬ê°€ ì•„ë‹ ê²½ìš° ì œí•œì ì¸ í†µê³„ëŸ‰(í‰ê· ,ë¶„ì‚°)ë§Œìœ¼ë¡œëŠ” ë¶„í¬ì˜ ì°¨ì´ë¥¼ ì˜ëª» ì„¤ëª…í•  ìˆ˜ ìˆë‹¤.

## Generative Adversarial Network (GAN) - Wrap-up: GANì˜ ì¥ë‹¨ì 
ì¥ì 
1. ì´ë¯¸ì§€ ìƒì„± ì‹œê°„(sampling)ì´ ë¹ ë¥´ë‹¤.
2. Inferenceê°€ ë”°ë¡œ ì—†ë‹¤.
3. ì´ë¯¸ì§€ í’ˆì§ˆì´ ì¢‹ë‹¤. (í•´ìƒë„ ë¬¸ì œëŠ” ê¸°ë³¸ GANì€ ìˆë‹¤! -> ì¶”í›„ ë°œì „ë˜ë©° í•´ê²°!)

ë‹¨ì 
1. ë³¸ì§ˆì ì¸ evaluation metrics ë¶€ì¡±
2. í•™ìŠµì˜ ë¶ˆì•ˆì •ì„± (i.e. mode collapse ë¬¸ì œ) -> ì¶”í›„ ì–´ëŠ ì •ë„ í•´ê²°ë¨
  - Mode collapse: ê° modeë“¤ì„ ë²ˆê°ˆì•„ ëŒì•„ê°€ë©´ì„œ ì „ì²´ì ì¸ ë°ì´í„° ë¶„í¬ë¥¼ ì°¾ì§€ ëª»í•˜ê³  í•œ ë²ˆì— í•˜ë‚˜ì˜ modeì—ë§Œ weightì„ ì¤˜, í•™ìŠµì´ ì˜ ë˜ì§€ ì•ŠëŠ” í˜•íƒœ.
3. ëª…ì‹œì ì¸í™•ë¥ ë°€ë„ë¥¼ì•Œìˆ˜ì—†ë‹¤.
4. latent vectorë¡œ ì—­ ë³€í™˜ì´ ì–´ë µë‹¤.

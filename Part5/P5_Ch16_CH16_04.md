# Meta Learning - 4. Optimization-based Meta Learning
## Optimization-based Meta Learning
- Optimization process(í˜¹ì€ optimizer)ë¥¼ ìŠ¤ìŠ¤ë¡œ í•™ìŠµí•  ìˆ˜ ìˆë„ë¡ í•œë‹¤. 
- Base-learnerì™€ Meta-learner ë‘ ê°€ì§€ë¥¼ ì‚¬ìš©í•´ì„œ Base-learnerëŠ” ì‹¤ì œë¡œ ë§¡ì€ ì—…ë¬´ë¥¼ train í•˜ê³  Meta-learnerëŠ” â€œbase networkë¥¼ optimizeâ€ í•˜ë„ë¡ ì—­í• ì„ êµ¬ì„±í•œë‹¤.

## Optimization-based Meta Learning - LSTM Meta-Learner (2016)
<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 02 38" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/eea845ae-f0e1-4ec4-8c21-7604291a56e7">

LSTMì„ meta-learner (optimizer)ë¡œ ëª¨ë¸ë§.   
Why?  
- LSTMì˜ cell state updateì™€ gradient ê¸°ë°˜ backpropagationì€ ë‹®ì•˜ë‹¤
- Gradient updateì˜ historyë¥¼ ì•„ëŠ” ê²ƒì€ ë‹¨ìˆœíˆ ì—…ë°ì´íŠ¸ í•˜ëŠ” ê²ƒë³´ë‹¤ ë‚«ë‹¤ (i.e. optimizationì˜ momentum)

## Optimization-based Meta Learning - LSTM Meta-Learner (2016)
LSTMì„ meta-learner (optimizer)ë¡œ ëª¨ë¸ë§.
- Base learner(ì§§ê²Œ learner) modelì„ $ğ‘€_\theta$ , meta learner modelì„ $ğ‘…_\Theta$ ë¼ê³  í•˜ì.
- Learner modelì˜ íŒŒë¼ë¯¸í„° ì—…ë°ì´íŠ¸ëŠ” ì›ë˜ì˜ SGD $ğœƒ_t = ğœƒ_{t-1}: âˆ’ ğ›¼_t âˆ‡_{\theta_{t-1}} ğ¿_t$
- ì—ì„œ, LSTMì—ì„œì˜ cell stateì˜ updateëŠ” ë‹¤ìŒì„ ë”°ë¥¸ë‹¤! (chapter 6ì°¸ê³ ) $ğ‘_t = ğ‘“_t â¨€ ğ‘_{t-1} + ğ‘–_t â¨€ \tilde{ğ‘_t}$
  - ë§Œì•½, forget gate( $ğ‘“_t$ )ë¥¼ í•­ìƒ 1ì´ë¼ ë‘ê³ , cell state $ğ‘_t$ ë¥¼ $ğœƒ_t$ , input gate( $ğ‘–_t$ )ë¥¼ $ğ›¼_t$ ë¼ í•˜ë©´,
  - ìœ„ì˜ ì‹ì€, $ğœƒ_t = ğœƒ_{t-1}: âˆ’ ğ›¼_t âˆ‡_{\theta_{t-1}} ğ¿_t$ ë¡œ ê°™ì•„ì§„ë‹¤!

- ì¦‰, LSTMì˜ cell stateì‹ì€ SGDì˜ ì¼ë°˜í™” ì‹ì´ë©°, $ğ‘“_t,ğ‘–_t$ ëŠ” í•™ìŠµ ê°€ëŠ¥í•œ ë‹¤ë¥¸ ê°’ì„ ì·¨í•´, datasetì— ë”°ë¼ adaptableí•˜ê²Œ ì ìš©ì‹œí‚¬ ìˆ˜ ìˆë‹¤!

## Optimization-based Meta Learning - LSTM Meta-Learner (2016)
<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 13 51" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/90461993-d3c7-44af-a678-595deb811049">

ì¼ë°˜í™” í•˜ì—¬, learner ëª¨ë¸ì˜ ì—…ë°ì´íŠ¸ ì‹ì„ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 13 28" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/e6f864e0-4f0a-411f-ac0f-513e5b92411d">

-> $R_\Theta ( \nabla_{\theta_{t-1}} L_t, L_t, \theta_{t-1}) = f_t â¨€ \theta_{t-1} + i_t â¨€ \tilde{\theta_t}$

## Optimization-based Meta Learning - LSTM Meta-Learner (2016)
<img width="599" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 16 42" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/573baac1-da40-4100-97ee-952eed903879">

## Optimization-based Meta Learning - Model-Agnostic Meta-Learning (MAML; 2017)
- SGDë¥¼ ì‚¬ìš©í•˜ëŠ” ì–´ë–¤ ëª¨ë¸ì´ë¼ë„ ì ìš©ê°€ëŠ¥í•œ meta-learning ì•Œê³ ë¦¬ì¦˜.
- ëª¨ë¸ì´ $ğ‘“_\theta$, taskë¥¼ $ğœ_i$, ê´€ë ¨ëœ ë°ì´í„° ì…‹ì„ ( $ğ·_{train}^{(i)} , ğ·_{test}^{(i)}$ )ì´ë¼ê³  í•œë‹¤ë©´, 
- ëª¨ë¸ íŒŒë¼ë¯¸í„°ë¥¼ 1ë²ˆ í˜¹ì€ ë” ë§ì€ gradient descent stepìœ¼ë¡œ ì—…ë°ì´íŠ¸ ê°€ëŠ¥ í•  ê²ƒì´ë‹¤.

  <img width="300" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/9bf2556d-2daf-43ca-8325-d47ae622d490">

- ë§Œì•½, 1ê°œ stepì´ê³ , 1ê°œì˜ datasetì´ë¼ë©´,
- <img width="150" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 22 14" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/5ad1c95d-a677-4020-890f-a1b852cd8be2">ì¼ ê²ƒì´ê³ , ì—¬ëŸ¬ taskë¡œ ì¼ë°˜í™” í•˜ë©´ meta-objectëŠ” ì•„ë˜ì˜ ì‹ìœ¼ë¡œ ìµœì í™” í•œë‹¤.
- <img width="280" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 22 48" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/6d2f3ad0-10e5-4232-8a34-540494b889b5">

## Optimization-based Meta Learning - Model-Agnostic Meta-Learning (MAML; 2017)
<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 25 41" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/d4ca6b56-779d-41f5-bbba-ed574aa229f6">
<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 25 58" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/fbf515d8-a4f9-4e36-8e46-34d98b55af35">
<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 26 14" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/fd4e58ae-278b-4b24-acf9-dd429a6c899d">

## Optimization-based Meta Learning - Model-Agnostic Meta-Learning (MAML; 2017) â€’ First-order version
<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 25 41" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/d4ca6b56-779d-41f5-bbba-ed574aa229f6">

Meta-optimizationì€ [8] ë¶€ë¶„! ë§Œì•½ íš¨ìœ¨ì ìœ¼ë¡œ í•œë‹¤ë©´?
- $ğœƒ_{meta} â† ğœƒ_{meta} âˆ’ ğ›½ğ‘”_{MAML}$

$ğ¿_{\tau_i}^1$ ì„metalearnerì˜í•™ìŠµ, $ğ¿_{\tau_i}^0$ ì„ learnerì˜ í•™ìŠµì´ë¼í•˜ì. 

<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 29 59" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/8a0484b5-3ca1-4c22-a84f-3cde0fda76c2">

- ìœ¼ë¡œ ì •ë¦¬ëœë‹¤. First-order ëŠ” $âˆ‡_{\theta_{i-1}} (âˆ‡_\theta ğ¿^0(ğœƒ_{i-1})$ ì„ ìƒëµí•œ í˜•íƒœë¡œ, <img width="150" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 31 11" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/1d6fe36c-9bf7-4957-9cd2-9f41883e95d8"> ì„ ë§Œì¡±í•œë‹¤.

## Optimization-based Meta Learning - Latent embedding optimization (LEO; 2018-2019)
<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 37 30" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/5faa1b18-d210-460e-a504-9ddd4cdab628">

<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 37 03" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/b058b046-8191-451b-b706-a57c5475e6f9">

- ë†’ì€ ì°¨ì›ì˜ íŒŒë¼ë¯¸í„° ìŠ¤í˜ì´ìŠ¤ì—ì„œ gradient informationì„ ì‚¬ìš©ê°€ëŠ¥í•˜ë„ë¡, ë‚®ì€ ì°¨ì›ì˜ Latent variable(z)ì„ ì‚¬ìš©.  
- Task $ğœ_j$ ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, í•´ë‹¹í•˜ëŠ” support set $D_{ğœ_j}^{tr}$ ë¥¼ encoderì— ë„£ê³ , hidden codeë¥¼ ì–»ì–´ë‚¸ë‹¤.
- ê·¸ hidden codeëŠ” ê°€ëŠ¥í•œ ëª¨ë“  ë°©ë²•ìœ¼ë¡œ pairë˜ê³ , concat ë˜ì–´, Nì´ training setì˜ classìˆ˜ê³ , kê°€ classë³„ sample ìˆ˜ì¼ë•Œ,
- $(ğ‘ğ‘˜)^2$ ì˜ pairê°€ ëœë‹¤.
- Paired codesëŠ” metric-basedë°©ë²•ì˜ relation networkì„ ì´ìš©í•˜ì—¬, latent ê°’ì„ ì–»ëŠ”ë‹¤.
- ê·¸ ê°’ì€, class ë³„ë¡œ ë‚˜íƒ€ë‚´ê³ , $ğ‘§_{nâˆˆX}$ ìœ¼ë¡œ í‘œí˜„ëœë‹¤.
- $ğ‘¥_n^l$ âˆˆ $D_{ğœ_j}^{tr}$ ì„ class nì˜ ğ‘™ ë²ˆì§¸ì˜ sampleì´ê³ , $ğœ™_e ,ğœ™_r$ ì´ encoderì™€ relation netì˜ parameter ë¼ê³  í•  ë•Œ ë‹¤ìŒê³¼ ê°™ì´ í‘œí˜„ë  ìˆ˜ ìˆë‹¤.

  <img width="350" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 36 34" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/b9ecc400-48b7-4c05-b34d-f7cd71c74695">

## Optimization-based Meta Learning - Latent embedding optimization (LEO; 2018-2019)
<img width="600" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 6 38 24" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/b5732933-ca75-464c-8121-a88f94912f06">

# Meta Learning - 1. Learning to Learn
## Meta Learningì´ë€?
- Meta-learningì€ ëª‡ëª‡ training ì˜ˆì œë¥¼ í†µí•´ì„œ ëª¨ë¸ë¡œ í•˜ì—¬ê¸ˆ, ìƒˆë¡œìš´ ê¸°ìˆ ì„ ë°°ìš°ê±°ë‚˜, ìƒˆë¡œìš´ í™˜ê²½ì— ë¹ ë¥´ê²Œ ì ì‘í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„í•˜ëŠ” ë°©ë²•ì´ë‹¤.
- â€œMetaâ€: í•œ ë‹¨ê³„ ë” ìƒìœ„ ë²„ì „ì˜ ì˜ë¯¸.
- ì¦‰, í•™ìŠµí•˜ëŠ” ê²ƒì„ í•™ìŠµí•˜ëŠ” ë°©ë²•ìœ¼ë¡œ, â€œLearning To Learnâ€ ì´ë¼ê³ ë„ ì•Œë ¤ì ¸ìˆë‹¤.
  - ì ì€ ìƒ˜í”Œë¡œì˜ Domain ì ì‘ (domain adaptation)ì´ë‚˜, few-shot learning ë“±ì„ ìœ„í•´ í™œìš©ëœë‹¤!
 
## Meta Learning ì´ì „ì˜ ê¸°ë³¸ì ì¸ ì ‘ê·¼ë²•? - Fine-tuning (transfer learning)
- Meta training dataë¥¼ í†µì§¸ë¡œ ì‚¬ìš©í•´ ë¨¼ì € í•™ìŠµ
  - ì‹¤ì œ ì ìš©í•˜ë ¤ëŠ” ë„ë©”ì¸ì— fine-tuning ì„ ì ìš©.
    
ë‹¨ì 
- ë‹¤ë¥¸ ë„ë©”ì¸ì— ê³§ë°”ë¡œ ì ìš©ì´ ë¶ˆê°€í•˜ë‹¤.(Fine-tuningì—ë„ ì ë‹¹í•œ ë ˆë²¨ì˜ ë°ì´í„° ì—­ì‹œ í•„ìš”í•˜ë‹¤, ì¦‰, few-shotì´ ë¶ˆê°€!)
  - ë‹¤ë¥¸ ë°©ë²•ì€..?

<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-08-31 á„‹á…©á„’á…® 9 18 29" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/c7a0cc07-c44f-4717-9569-dcbefd3f22cd">

## Meta Learning - Recap: Few-shot learning
Few-shot learningì€?
- ë°ì´í„° ìˆ˜ê°€ ë§¤ìš° ì ì€ ë¬¸ì œë¡œ few-shot trainingì— ì‚¬ìš©í•˜ëŠ” ì„œí¬íŠ¸ ë°ì´í„°(support data)ì™€ testì— ì‚¬ìš©í•˜ëŠ” ì¿¼ë¦¬ ë°ì´í„°(query data)ë¡œ êµ¬ì„±ëœë‹¤.
- ë²”ì£¼(class)ì˜ ìˆ˜ë¥¼ N, ë²”ì£¼ ë³„ support dataì˜ ìˆ˜ë¥¼ Kë¼ í•  ë•Œ, 'N-way K-shot' ë¬¸ì œë¼ê³  ë¶€ë¥¸ë‹¤! ë§Œì•½, Kê°€ 1ì´ë¼ë©´, one-shot learning, Kê°€ 0ì´ë¼ë©´ zero-shot learningì´ë¼ê³ ë„ ë¶€ë¥¸ë‹¤! (Remind GPT2, GPT3)
- Meta learningì€ few-shot learningì˜ ì¼ë°˜ì ì¸ í•´ê²°ë°©ë²•ì´ë‹¤!

## Meta Learning ë¬¸ì œ
ì¢‹ì€ meta-learning modelì€?
- í•™ìŠµí•˜ë ¤ëŠ” taskì˜ ë‹¤ì–‘ì„±(variety)ì„ í•™ìŠµí•  ìˆ˜ ìˆì–´ì•¼ í•˜ë©°, ì¸ì§€ë˜ì§€ ëª»í•œ ì ì¬ taskë¥¼ í¬í•¨í•˜ì—¬
- ì—¬ëŸ¬ taskì˜ ë¶„í¬ ìƒì—ì„œë„ ì¢‹ì€ ì„±ëŠ¥ì„ ë‚¼ ìˆ˜ ìˆë„ë¡ ìµœì í™”ë˜ì–´ì•¼ í•œë‹¤.
- ê° taskë“¤ì´ dataset ğ· ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤ë©´, ì—¬ê¸°ì— ê°ê° feature vectorë“¤ê³¼ true labelë“¤ì´ í¬í•¨ë˜ì–´ ìˆë‹¤!
- ì´ë•Œ optimal modelì˜ parameterëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

  <img width="200" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 3 40 47" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/6132c4b8-c158-4ea7-9821-db6f95096d8d">

- ì¦‰, ì—¬ëŸ¬ ê°œì˜ ë°ì´í„° ì…‹ ì¤‘ì—ì„œ ìƒ˜í”Œë§ ëœ dataset ğ·ì— ëŒ€í•´, loss function $ğ¿_\theta(ğ·)$ ì„ ìµœì†Œí™”í•  ìˆ˜ ìˆëŠ” ğœƒì„ ì°¾ëŠ”ë‹¤!

## Meta Learning ë¬¸ì œ
<img width="500" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 3 42 22" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/dcaef813-3214-4d22-82dc-9554fa57d233">

Meta learning modelì˜ optimal modelì˜ parameterëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

<img width="200" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 3 40 47" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/6132c4b8-c158-4ea7-9821-db6f95096d8d">

ìœ„ì˜ ì‹ì€ ì¼ë°˜ì ì¸ learning taskì™€ ìœ ì‚¬í•˜ì§€ë§Œ, í•˜ë‚˜ì˜ dataset ìì²´ê°€ í•˜ë‚˜ì˜ data sampleë¡œ í™œìš©ë˜ê³  ìˆë‹¤.  
Few-shot classification? -> supervised learning ìƒì—ì„œ meta-learningì„ í™œìš©í•œ ì˜ˆì‹œ.

## Meta Learning - Trainingì„ Testingê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ë°”ë¼ë³´ëŠ” ê´€ì 
<img width="200" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 3 40 47" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/6132c4b8-c158-4ea7-9821-db6f95096d8d">

- ì—ì„œ, classificationì´ë¼ë©´,
- dataset DëŠ” ì—¬ëŸ¬ ìŒì˜ feature vectorì™€ labelë“¤ì„ í¬í•¨í•˜ê³  ìˆê³ , ğ· = { $(ğ‘¥_i,ğ‘¦_i)$ } ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤ ì´ë•Œ $y_i$ ëŠ” ê° label set $ğ¿_{all}$ ì— í¬í•¨ë˜ì–´ìˆë‹¤ê³  í•´ë³´ì.
- ì´ë•Œ íŒŒë¼ë¯¸í„° ğœƒë¥¼ ê°€ì§„ classifier $ğ‘“_\theta$ ëŠ” ì£¼ì–´ì§„ ë°ì´í„°ê°€ feature vector xì— ëŒ€í•´ class yì— ì†í•  í™•ë¥ ì¸ $ğ‘ƒ_\theta (ğ‘¦|ğ‘¥)$ ë¥¼ ì¶œë ¥ìœ¼ë¡œ ë‚´ë³´ë‚¼ ê²ƒì´ë‹¤.
- ì´ë•Œ, training batchë¥¼ Bë¼ê³  ë‚˜íƒ€ë‚´ë©´, ìœ„ì˜ ì‹ì€ ì•„ë˜ì™€ ê°™ì´ í‘œí˜„ë  ìˆ˜ ìˆë‹¤.

  <img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 3 50 17" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/5f5f4df3-66e8-491d-9779-01db4801142c">

## Meta Learning - Trainingì„ Testingê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ë°”ë¼ë³´ëŠ” ê´€ì 
- Few-shot classificationì˜ ëª©í‘œëŠ” "fast learning" ì„ ìœ„í•´ì„œ ì¶”ê°€í•œ, ì•½ê°„ì˜ support setì„ ê°€ì§€ê³ , unknown labelì— ëŒ€í•œ ë°ì´í„°ì˜ prediction errorë¥¼ ì¤„ì´ëŠ” ê²ƒì´ë‹¤. ("fine-tuning"ì´ ìˆ˜í–‰ë˜ëŠ” ê³¼ì •ê³¼ ìœ ì‚¬)

- ëª¨ë¸ì´ ëª¨ë“  labelì— ëŒ€í•´ì„œ ì¸ì§€í•˜ê³ , optimization procedureë¥¼ ìˆ˜ì •í•˜ëŠ” ê²ƒ ì—†ì´, ê¶ê·¹ì ìœ¼ë¡œ fast learningì´ ì´ë¤„ì§ˆ ìˆ˜ ìˆë„ë¡ í•˜ì.
  - Inference ì¤‘ì—ë„ training processë¥¼ ëª¨ë°©í•œ ê³¼ì •ì„ ë„£ê¸° ìœ„í•´ì„œ, datasetì— ì•½ê°„ì˜ ìˆ˜ì •.

1. Label setì—ì„œ ì¼ë¶€ë¥¼ ìƒ˜í”Œë§ í•œë‹¤. $ğ¿ âŠ‚ ğ¿_{all}$ 
2. Support setê³¼ training batchë¥¼ datasetë¡œë¶€í„° ìƒ˜í”Œë§í•œë‹¤. ( $ğ‘†^L âŠ‚ ğ·, ğµ^L âŠ‚ ğ·$ )
   - ğ¿ì— ì†í•˜ëŠ” labelì„ ê°€ì§„ ë°ì´í„°ë§Œ ê°€ì§€ê³  ìˆì–´ì•¼ í•œë‹¤. ğ‘¦ âˆˆ ğ¿, âˆ€(ğ‘¥,ğ‘¦) âˆˆ $ğ‘†^L, ğµ^L$ 
3. Support set( $ğ‘†^L$ )ì€ model inputì˜ ë¶€ë¶„ì´ë‹¤.
4. Final optimization ë‹¨ê³„ì—ì„œ supervised learningì—ì„œ í•˜ëŠ” ê²ƒê³¼ ë™ì¼í•œ ë°©ë²•ìœ¼ë¡œ mini-batch $ğµ^L$ ì„ ì´ìš©í•˜ì—¬ lossë¥¼ ê³„ì‚°í•˜ê³  backpropagationì„ í†µí•´ model parameterì„ ì—…ë°ì´íŠ¸ í•œë‹¤.


<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 3 56 22" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/4febc6b5-fe43-49e1-9556-77bb66cdbd17">
ì€, ì•ì˜ 1~4ê³¼ì •ì„ ë‹¤ë¥¸ datasetì„ í¬í•¨í•˜ë„ë¡ ì¼ë°˜í™”í•  ìˆ˜ ìˆë‹¤.   

ì¦‰, ë‹¤ìŒì˜ meta learning ì‹ìœ¼ë¡œ ë‹¤ì‹œ í‘œí˜„ë  ìˆ˜ ìˆë‹¤. 
<img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 3 57 03" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/ace0ee93-ed91-41d0-bbbb-49b762ee07aa">

-> Transfer learning (pre-training + fine-tune)ë„ ë„“ì€ ì˜ë¯¸ì—ì„œ ìœ„ ì‹ì— í¬í•¨ë  ìˆ˜ ìˆë‹¤.

## Meta Learning - Learnerì™€ Meta-learnerì˜ 2ê°€ì§€ í•™ìŠµê³¼ì •ìœ¼ë¡œ ë³´ëŠ” ê´€ì 
Meta learningì„ ë°”ë¼ë³´ëŠ” ë˜ë‹¤ë¥¸ ê´€ì ì€ model updateí•˜ëŠ” ê³¼ì •!

- ë³´í†µ ëª¨ë¸ updateëŠ” ë‘ ë‹¨ê³„ë¡œ ë‚˜íƒ€ë‚´ì§ˆ ìˆ˜ ìˆë‹¤.
  - $ğ‘“_\theta$ ë¥¼ ì „í†µì ì¸ classifierí˜•íƒœì˜ learner ëª¨ë¸ì´ë¼ í•˜ê³ , ì£¼ì–´ì§„ taskì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ í•™ìŠµí•œë‹¤.
  - ê·¸ë™ì•ˆ, optimizer $ğ‘”_\phi$ ëŠ” ì£¼ì–´ì§„ support set Sì„ ê°€ì§€ê³ , learner modelì˜ parameter ğœƒì„ updateí•˜ëŠ” ë°©ë²•ì„ í•™ìŠµí•œë‹¤.
    - (ğœƒâ€² = $ğ‘”_\phi$ (ğœƒ, ğ‘†))
- Final optimization stepì—ì„œëŠ” ğœƒì™€ ğœ™ì„ ë‘˜ë‹¤ ì—…ë°ì´íŠ¸ í•œë‹¤!

<img width="345" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 05 21" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/81bd07c3-c071-4cbd-a049-f456b977b42c">

## Meta Learningì˜ ì¢…ë¥˜
ë³´í†µ 3ê°œ ì •ë„ì˜ ì ‘ê·¼ ë°©ì‹ì´ ìˆë‹¤.
  
1.(metric-based) efficient distance metricì„ í•™ìŠµí•˜ê³  ì´ë¥¼ ì´ìš©í•˜ëŠ” ë°©ì‹  
   
   <img width="200" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-01 á„‹á…©á„’á…® 4 06 46" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/025a9c9c-f8c2-4c05-876d-d11bc3c51b20">
(k: similarity measure)   

  - 14ê°•ì—ì„œ ë‹¤ë¤˜ë˜ metric learningì„ ì‘ìš©!
    
2. (model-based) external/internal memoryë¥¼ ê°€ì§„ ëª¨ë¸ì„ ì‚¬ìš©í•˜ëŠ” ë°©ì‹
   - $ğ‘ƒ_\theta (ğ‘¦|ğ‘¥) â†’ ğ‘“_\theta(ğ‘¥,ğ‘†)$  
3. (optimization-based) fast learningì„ ìœ„í•œ model parameterë¥¼ ìµœì í™”í•˜ëŠ” ë°©ì‹.
   - $ğ‘ƒ_\theta (ğ‘¦|ğ‘¥) â†’ P_{g_\phi (\theta, S^L)} (y|x)$  
  

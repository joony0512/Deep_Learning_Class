# Research Topics for Productions - 3. Auto-ML
## Back to the ML pipeline - Why Auto-ML?
<img width="500" alt="image" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/90775b55-b02f-4c1f-8a89-298b2d3d08e6">

Train íŒŒì´í”„ë¼ì¸ì„ ë‹¤ ë§Œë“¤ê³ , íŠœë‹ì—†ì´ ë°ì´í„°ë§Œ ê¾¸ì¤€íˆ ì—…ë°ì´íŠ¸í•˜ì—¬ ëª¨ë¸ weightì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ìƒí™©ì„ ê°€ì •í•´ë³´ì.   
ìš°ë¦¬ì˜ ê¸°ì¡´ ëª¨ë¸ì€ ì—¬ì „íˆ SOTAì¼ê¹Œ?   

## Auto-ML - Auto-MLì˜ ì¢…ë¥˜
<img width="500" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 04 10" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/c447116f-6cff-4361-b47a-eb92d150259d">

<img width="500" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 04 35" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/0fd69f3b-01e0-479a-8ee8-06aa2de251ad">

ìµœê·¼ì˜ ì—°êµ¬í† í”½ì€ Hyper Parameter Optimization (HPO), Neural Architecture Search (NAS) ì´ ì£¼ë¥¼ ì´ë£¨ê³ ,  
ë„“ì€ ì˜ë¯¸ì—ì„œ meta-learning ë“±ë„ í¬í•¨ì‹œí‚¤ê¸°ë„ í•œë‹¤.

## Auto-ML - Hyper-Parameter Optimization (HPO)
ë™ì¼í•œ ML ëª¨ë¸ì—ì„œ Hyperparameter ë¥¼ ìµœì í™”í•˜ì—¬ íŠœë‹í•˜ëŠ” ê¸°ë²•.   
í¬ê²Œ, Grid / Random Search(model free approach)ì™€ Bayesian Optimization (Bol model based approach)ê°€ ì£¼ë¥¼ ì´ë£¬ë‹¤  
- Grid search: search spacedì„ ë‚˜ëˆ„ê³  ì¼ì • ê°„ê²©ìœ¼ë¡œ searchë¥¼ ì§„í–‰í•œë‹¤. 
- Random search: ëœë¤ìœ¼ë¡œ hyper parameterë¥¼ searchí•œë‹¤.

<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 11 28" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/1e1edb37-58e1-4093-a63b-5aab0e0ede37">

- Bayesian optimization: sequential model-based optimization(SMBO)ë¡œ validation setì— ëŒ€í•´ í™•ë¥ ë¡ ì ìœ¼ë¡œ hyperparameterë¥¼ ë½‘ëŠ”ë‹¤.
ì´ë•Œ ë½‘ëŠ” ê¸°ì¤€ì€, valid setì— ëŒ€í•´ ì§„í–‰ì„ í•œë‹¤.
- Evaluation í•¨ìˆ˜ë¥¼ f, search spaceë¥¼ Î˜, ìŠµë“ í•¨ìˆ˜ë¥¼ ğ‘†, í™•ë¥ ì ì¸ ëª¨ë¸ì„ M, Record dataset ì„ ğ·ì´ê³ 
- ê° ìƒ˜í”Œì„ $(ğœƒ_i,ğ‘¦_i)$ âˆˆ ğ·ì´ê³  $ğœƒ_i âˆˆ \Theta$ì„ ìƒ˜í”Œë§ëœ neural architecture, $ğ‘¦_i$ ì„ í‰ê°€ëœ ë°©ë²•ì´ë¼ í•œë‹¤ë©´ SMBOëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
  
  <img width="487" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 13 50" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/1d4c1987-3065-4688-9522-444726a34faa">

- ê° ë°©ë²•ì„ í’€ë©´, ì•„ë˜ì™€ ê°™ê³  Të²ˆ ë°˜ë³µí•œë‹¤.
  1. record dataset(D) ì— probabilistic model Mì„ fití•˜ê¸° ìœ„í•´ tuneí•œë‹¤.
  2. ìŠµë“ í•¨ìˆ˜ SëŠ” probabilistic model Mìœ¼ë¡œë¶€í„° ë‹¤ìŒ neural networkë¥¼ ë½‘ê³ , $ğœƒ_i$ ë¥¼ ì¶”ì¶œí•œë‹¤.
  3. fë¥¼ í†µí•´ neural networkë¥¼ í•™ìŠµ/í‰ê°€í•œë‹¤.
  4. record datasetì„ $(ğœƒ_i,ğ‘¦_i)$ ì„ updateí•œë‹¤.

## Auto-ML - Hyper-Parameter Optimization (HPO)
ì‹¤ë¬´ì—ì„œëŠ”?  
ì§ì ‘ êµ¬í˜„í•˜ì§€ ì•Šì•„ë„, ë‹¤ì–‘í•œ open-source ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš© ê°€ëŠ¥! 
- Ray Tune, Optuna, HyperOpt, NNI Tuner, Mango ë“±

## Auto-ML - Neural Architecture Search (NAS)
<img width="350" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 22 50" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/cc8263df-1e4d-4372-9193-7541d039cdf9">

<img width="350" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 22 08" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/ca833169-a79f-41c0-a5aa-0987ff72f7e4">

Search spaceë¥¼ ì–´ë–»ê²Œ ì„¤ì •í–ˆëŠëƒ, Architecture optimizationì„ ì–´ë–¤ ë°©ë²•ìœ¼ë¡œ í–ˆëŠëƒ, ì–´ë–¤ estimationìœ¼ë¡œ í–ˆëŠëƒì— ë”°ë¼ NASì˜ ì¢…ë¥˜ê°€ ë‹¬ë¼ì§„ë‹¤!
- Model generationë¶€ë¶„ ìœ„ì£¼ë¡œ ì•Œì•„ë³´ì

## Auto-ML - Neural Architecture Search (NAS) â€’ Search space: Sequential layer-wise operation
<img width="450" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 24 43" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/5bab9ef7-c287-4496-ae49-979e6cd2e3d8">

- NASì˜ search spaceì„ ì„¤ê³„í•˜ëŠ” ê°€ì¥ ë‹¨ìˆœí•œ ë°©ë²•ì€ ì´ˆê¸° ì—°êµ¬ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” ìˆœì°¨ì  ê³„ì¸µë³„ ìš´ì˜ ëª©ë¡ì„ ì‚¬ìš©í•˜ì—¬ networkì˜ ìœ„ìƒ ë°°ì¹˜ë¥¼ ë¬˜ì‚¬í•˜ëŠ” ê²ƒ  
- ë„¤íŠ¸ì›Œí¬ í‘œí˜„ì˜ serializationì€ ê° ìš´ì˜ì´ ì„œë¡œ ë‹¤ë¥¸ ê³„ì¸µë³„ parameterì™€ ì—°ê´€ë˜ì–´ ìˆê³  ê·¸ëŸ¬í•œ ì—°ê´€ì„±ì€ í•˜ë“œ ì½”ë”©ë  í•„ìš”ê°€ ìˆê¸° ë•Œë¬¸ì— ìƒë‹¹í•œ ì–‘ì˜ ì „ë¬¸ê°€ ì§€ì‹ì´ í•„ìš”!
  - (i.e. convolution ì‘ì—…ì„ ì˜ˆì¸¡í•œ í›„ ëª¨ë¸ì€ ì»¤ë„ í¬ê¸°, ìŠ¤íŠ¸ë¼ì´ë“œ í¬ê¸° ë“±ì„ ì¶œë ¥í•´ì•¼í•˜ë©°, FC ì‘ì—…ì„ ì˜ˆì¸¡í•œ í›„ì—ëŠ” ë‹¨ìœ„ ìˆ˜ë¥¼ ë‹¤ìŒ ì˜ˆì¸¡ìœ¼ë¡œ ë³´ì•„ì•¼ í•œë‹¤.)
- ëª¨ë¸ì´ validí•˜ì§€ ì•Šì„ ê°€ëŠ¥ì„±ì´ ìˆê¸° ë•Œë¬¸ì—, ê²€ì¦ í”„ë¡œì„¸ìŠ¤ê°€ ìˆì–´ì•¼ í•œë‹¤.

## Auto-ML - Neural Architecture Search (NAS) â€’ Search space: cell-based representation
<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 27 54" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/2c4124f7-3a3d-4d70-b886-cfe656333378">

<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 27 34" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/20675560-779d-41fb-bded-ae2479d7d841">

- Normal cellê³¼ reduction cell (motifs)ë¡œ ë‚˜ëˆ„ê³ , ë¯¸ë¦¬ ì •ì˜í•´ë‘” ë‚´ì—ì„œ cell representationì„ í•™ìŠµí•˜ê²Œ í•œë‹¤. -> ì—¬ëŸ¬ ê°œë¥¼ ì‚¬ìš©ê°€ëŠ¥í•˜ê²Œ
- 2ê°œì˜ typeì„ í•™ìŠµ (normal cell, reduction cell)
  - ê²€ìƒ‰ ê³µê°„ì´ ëŒ€í­ ì¤„ì–´ë“ ë‹¤!
  - NASì˜ ê²°ê³¼ë¬¼ì„ ë‹¤ë¥¸ ë°ì´í„°ì…‹ìœ¼ë¡œ ì‰½ê²Œ ì „ì†¡ ê°€ëŠ¥í•˜ë‹¤
  - ì•„í‚¤í…ì²˜ ì—”ì§€ë‹ˆì–´ë§ì—ì„œ ëª¨ë“ˆì„ ë°˜ë³µì ìœ¼ë¡œ ìŒ“ëŠ” ìœ ìš©í•œ ì„¤ê³„ íŒ¨í„´ì˜ ê°•ë ¥í•œ ì¦ê±°

## Auto-ML - Neural Architecture Search (NAS) â€’ Search space: structured
<img width="500" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 28 36" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/ebfb0e20-ae27-4d86-bdd9-733080b1f593">

<img width="500" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 28 54" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/c7a20028-da02-40bc-9056-96dc2a908b0e">

- Direct acyclic graph í˜•íƒœë‚˜ Treeêµ¬ì¡° í˜•íƒœë¡œ êµ¬ì¡°ë¥¼ ì¡ëŠ” ë°©ì‹ë„ ì¡´ì¬!

## Auto-ML - Neural Architecture Search (NAS) â€’ Search algorithm â€’ ìµœì´ˆ? ê°•í™” í•™ìŠµ (RL)
<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 32 05" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/b05a19c8-5672-4dcf-8d12-916e8cb851b0">

- Action space: child networkì„ ì •ì˜í•˜ê¸° ìœ„í•œ í† í° ëª©ë¡. 
- T: tokenì˜ ìˆ˜
- Controller (RNN): Actionì„ returní•œë‹¤!
- Reward: child networkì˜ tuningì„ ë§ˆì¹œ í›„ì— ì–»ì–´ì§€ëŠ” accuracyì„ rewardë¡œ ì‚¼ëŠ”ë‹¤!
- Loss: REINFORCE ì•Œê³ ë¦¬ì¦˜(loss)ë¡œ controllerì˜ parameter(ğœƒ)ì„ ìµœì í™”í•œë‹¤.
  - Expected reward(ë†’ì€ ì •í™•ë„)ì„ ê·¹ëŒ€í™”! ì•„ë˜ì˜ ëª©ì  í•¨ìˆ˜ì˜ ê¸°ìš¸ê¸°ë¥¼ ì—…ë°ì´íŠ¸ í•œë‹¤.

    <img width="300" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 31 07" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/1a5b8294-1cad-4ba6-91f1-d3cfab8121c1">

- ì°¸ê³ : ê·¸ ì™¸ ì–´ë– í•œ RL ì•Œê³ ë¦¬ì¦˜ë„ ì‚¬ìš©ê°€ëŠ¥í•˜ë‹¤. - ì˜ˆ) ğœ–-greedy ê¸°ë°˜ì˜ Q-learning: MetaQNN

## Auto-ML - Neural Architecture Search (NAS) â€’ Search algorithm â€’ ê·¸ì™¸ search algorithmì€?
- Evolutionary algorithm(EA): ìœ ì „ ì•Œê³ ë¦¬ì¦˜ (genetic algorithm) ë“±ì„ ì´ìš©í•´ ìµœì í™” í•˜ëŠ” ë°©ë²•.
  - i.e.) AmoebaNet(2018), HNAS (2017)  
- Progressive Decision Process: Search modelë¡œ í•˜ì—¬ê¸ˆ ê°„ë‹¨í•œ ëª¨ë¸ì—ì„œ search í–ˆë‹¤ê°€, ì ì°¨ì ìœ¼ë¡œ ë³µì¡í•œ searchë¥¼ í•  ìˆ˜ ìˆê²Œ curriculumì„ ë„ì….
  - i.e.) Progressive NAS (PNAS; 2018)
- Gradient Descent: Child model evaluation (í•™ìŠµ)ê³¼ ê°™ì´ ì§„í–‰! -> One-shot ì ‘ê·¼ë²•
  - i.e. DARTS (2019), SNAS(2019)

## Auto-ML - ë” ê³µë¶€í•˜ë ¤ë©´?
<img width="400" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-07 á„‹á…©á„’á…® 5 40 36" src="https://github.com/joony0512/Deep_Learning_Class/assets/109457820/4e4b22ea-a20e-42eb-856a-a79787b21b4d">

ë¦¬ë·° ë…¼ë¬¸
  - He, Xin, Kaiyong Zhao, and Xiaowen Chu. "AutoML: A Survey of the State-of-the-Art." Knowledge-Based Systems 212 (2021): 106622.
  - Elsken, Thomas, Jan Hendrik Metzen, and Frank Hutter. "Neural architecture search: A survey." The Journal of Machine Learning Research 20.1 (2019): 1997-2017.

AutoML book
  - https://www.automl.org/book/

ì˜ ìš”ì•½ëœ ë¸”ë¡œê·¸ ì‚¬ì´íŠ¸ (NAS)
  - https://lilianweng.github.io/lil-log/2020/08/06/neural-architecture-search .html#one-shot-approach-search--evaluation
